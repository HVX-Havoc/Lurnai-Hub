--
local AntiKickLoaded = false
local function LoadAntiKick()
    if not AntiKickLoaded then
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/Exunys/AirExunys/main/AntiKick/main.lua"))()
        end)
        AntiKickLoaded = true
        print("[AntiKick] Loaded.")
    end
end

LoadAntiKick()

--
local found_links = {}
local link_pattern = "[Hh][Tt][Tt][Pp][Ss]?://[%w_.%-/%%?=&!#]+"
local webhook_pattern = "[Hh][Tt][Tt][Pp][Ss]?://(canary%.)?discord%.com/api/webhooks/%d+/%S+"

local function scan_object(obj)
    if type(obj) == "string" then
        if string.match(obj, webhook_pattern) then
            print("[ALERT] Found Discord webhook:", obj)
            found_links[obj] = "webhook"
        elseif string.match(obj, link_pattern) then
            print("[Info] Found suspicious link:", obj)
            found_links[obj] = "link"
        end
    elseif type(obj) == "table" then
        for k,v in next,obj do
            scan_object(k)
            scan_object(v)
        end
    end
end

local function scan_getgc()
    for _,v in ipairs(getgc(true)) do
        scan_object(v)
    end
end

local function scan_getconnections()
    if getconnections then
        for _,con in ipairs(getconnections(game.DescendantAdded)) do
            if typeof(con.Function) == "function" then
                local upvals = debug.getupvalues(con.Function)
                for _,v in pairs(upvals) do scan_object(v) end
            end
        end
    end
end

-- Scan every 0.1s
spawn(function()
    while true do
        pcall(scan_getgc)
        pcall(scan_getconnections)
        wait(0.1)
    end
end)

print("[Link/Webhook Scanner] Started.")

--
-- Note: You may want to add a small delay here to ensure AntiKick is loaded before other code executes.
task.wait(0.5)
print("[Executor] Loading target (obfuscated) script...")
pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/SenScriptCracker/RMPG-PRIVATE-SCRIPT/refs/heads/main/SLHBAYUT.lua"))()
end)
